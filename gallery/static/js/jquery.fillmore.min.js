/*!
 * jQuery Fillmore
 * Version 1.4.0
 * https://github.com/gregjacobs/jquery-fillmore
 *
 * Add a dynamically-resized background image to any element
 *
 * Copyright (c) 2012 Gregory Jacobs with Aidan Feldman (jux.com)
 * Dual licensed under the MIT and GPL licenses.
 */
(function(a){a.Fillmore=function(c){this.init(c)};a.Fillmore.defaultSettings={src:null,focusX:50,focusY:50,speed:0,onImageLoad:undefined,onImageVisible:undefined,callback:undefined};var b=function(ah,ag,af){function Q(f,e){var h=f.charAt(0).toUpperCase()+f.substr(1),g=(f+" "+U.join(h+" ")+h).split(" ");return S(g,e)}function S(e,c){for(var f in e){if(Y[e[f]]!==af){return c=="pfx"?e[f]:!0}}return !1}function E(d,c){return !!~(""+d).indexOf(c)}function F(d,c){return typeof d===c}function G(d,c){return H(V.join(d+";")+(c||""))}function H(c){Y.cssText=c}var ae="2.0.6",ad={},ac=ag.documentElement,ab=ag.head||ag.getElementsByTagName("head")[0],aa="modernizr",Z=ag.createElement(aa),Y=Z.style,X,W=Object.prototype.toString,V=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),U="Webkit Moz O ms Khtml".split(" "),T={},R={},P={},O=[],M=function(f,q,p,o){var n,m,l,h=ag.createElement("div");if(parseInt(p,10)){while(p--){l=ag.createElement("div"),l.id=o?o[p]:aa+(p+1),h.appendChild(l)}}n=["&shy;","<style>",f,"</style>"].join(""),h.id=aa,h.innerHTML+=n,ac.appendChild(h),m=q(h,f),h.parentNode.removeChild(h);return !!m},K,J={}.hasOwnProperty,I;!F(J,af)&&!F(J.call,af)?I=function(d,c){return J.call(d,c)}:I=function(d,c){return c in d&&F(d.constructor.prototype[c],af)};var N=function(j,i){var h=j.join(""),e=i.length;M(h,function(o,n){var m=ag.styleSheets[ag.styleSheets.length-1],l=m.cssRules&&m.cssRules[0]?m.cssRules[0].cssText:m.cssText||"",k=o.childNodes,g={};while(e--){g[k[e].id]=k[e]}ad.touch="ontouchstart" in ah||g.touch.offsetTop===9},e,i)}([,["@media (",V.join("touch-enabled),("),aa,")","{#touch{top:9px;position:absolute}}"].join("")],[,"touch"]);T.touch=function(){return ad.touch},T.backgroundsize=function(){return Q("backgroundSize")};for(var L in T){I(T,L)&&(K=L.toLowerCase(),ad[K]=T[L](),O.push((ad[K]?"":"no-")+K))}H(""),Z=X=null,ad._version=ae,ad._prefixes=V,ad._domPrefixes=U,ad.testProp=function(c){return S([c])},ad.testAllProps=Q,ad.testStyles=M;return ad}(this,this.document);a.Fillmore.useCss3=b.backgroundsize&&!(b.touch&&window.navigator.userAgent.match(/OS 4_/));a.extend(a.Fillmore.prototype,{fillmoreElPosition:"absolute",imageLoaded:false,imageVisible:false,init:function(d){this.settings=a.extend({},a.Fillmore.defaultSettings);var c=this.$containerEl=a(d);c.css("background","transparent");if(c.is("body")){this.fillmoreElPosition="fixed"}else{this.originalContainerOverflow=c[0].style.overflow;c.css("overflow","hidden");if(c.css("position")==="static"){c.css("position","relative");this.containerPositionModified=true}if(c.css("z-index")==="auto"){c.css("z-index",0);this.containerZIndexModified=true}}if(this.$containerEl.is("body")){this.$containerSizingEl=("onorientationchange" in window)?a(document):a(window)}else{this.$containerSizingEl=this.$containerEl}this.createFillmoreEl()},createFillmoreEl:function(){this.$fillmoreEl=a('<div style="left: 0; top: 0; position: '+this.fillmoreElPosition+'; overflow: hidden; z-index: -999999; margin: 0; padding: 0; height: 100%; width: 100%;" />').appendTo(this.$containerEl)},updateSettings:function(c){this.settings=a.extend(this.settings,c)},getSrc:function(){return this.settings.src},getImageEl:function(){throw new Error("getImageEl() must be implemented in subclass")},getImageSize:function(){if(!this.imageLoaded){return null}else{var c=this.getImageEl()[0];return{width:c.width,height:c.height}}},calculateStretchedSizeAndOffsets:function(){var p=this.getImageEl(),d=p[0];p.css({width:"auto",height:"auto"});var j=d.width||p.width(),l=d.height||p.height(),g=j/l,h=this.settings,i=this.$containerEl,k=this.$containerSizingEl,o=k.outerHeight()||k.height(),m=k.outerWidth()||k.width(),f=0,e=0,n=m,c=n/g;if(c>=o){e=(c-o)*this.settings.focusY/100}else{c=o;n=c*g;f=(n-m)*this.settings.focusX/100}return{offsetLeft:f,offsetTop:e,stretchedWidth:n,stretchedHeight:c}},getViewableImageArea:function(){if(!this.imageLoaded){return null}else{var c=this.$containerEl,d=this.calculateStretchedSizeAndOffsets();return{width:c.innerWidth(),height:c.innerHeight(),offsetLeft:d.offsetLeft,offsetTop:d.offsetTop,stretchedWidth:d.stretchedWidth,stretchedHeight:d.stretchedHeight}}},showImage:function(c){this.imageLoaded=false;this.imageVisible=false;this.loadImage(c)},loadImage:function(){throw new Error("loadImage() must be implemented in subclass")},isLoaded:function(){return this.imageIsVisible()},imageIsLoaded:function(){return this.imageLoaded},imageIsVisible:function(){return this.imageVisible},resize:function(){throw new Error("resize() must be implemented in subclass")},onImageLoad:function(c){this.imageLoaded=true;var d=this.settings.onImageLoad;if(typeof d==="function"){d()}if(this.settings.speed){this.$fillmoreEl.hide().fadeIn(this.settings.speed,a.proxy(this.onImageVisible,this));this.settings.speed=0}else{this.onImageVisible()}},onImageVisible:function(e){this.imageVisible=true;var c=this.settings,d=c.onImageVisible||c.callback;if(typeof d==="function"){d()}},destroy:function(){if(this.containerPositionModified){this.$containerEl.css("position","")}if(this.containerZIndexModified){this.$containerEl.css("z-index","")}this.$containerEl.css("overflow",this.originalContainerOverflow);this.$fillmoreEl.remove()}})})(jQuery);(function(a){a.FillmoreCss3=function(b){a.Fillmore.apply(this,arguments)};a.extend(a.FillmoreCss3.prototype,a.Fillmore.prototype,{$imgEl:null,createFillmoreEl:function(){a.Fillmore.prototype.createFillmoreEl.apply(this,arguments);this.$fillmoreEl.css({"background-repeat":"no-repeat","background-size":"cover"})},updateSettings:function(b){a.Fillmore.prototype.updateSettings.apply(this,arguments);this.$fillmoreEl.css("background-position",this.settings.focusX+"% "+this.settings.focusY+"%")},getImageEl:function(){return this.$imgEl||null},resize:function(){},loadImage:function(b){this.$imgEl=a("<img />").bind("load error",a.proxy(this.onImageLoad,this));this.$imgEl.attr("src",b)},onImageLoad:function(b){var c=this.$imgEl[0].src;this.$fillmoreEl.css("background-image","url('"+c+"')");a.Fillmore.prototype.onImageLoad.apply(this,arguments)}})})(jQuery);(function(a){a.FillmoreImageStretch=function(b){a.Fillmore.apply(this,arguments)};a.extend(a.FillmoreImageStretch.prototype,a.Fillmore.prototype,{$imgEl:null,$oldImage:null,init:function(b){a.Fillmore.prototype.init.apply(this,arguments);this.resizeProxy=a.proxy(this.resize,this);a(window).resize(this.resizeProxy)},getImageEl:function(){return this.$imgEl||null},loadImage:function(b){this.$oldImage=this.$imgEl;this.$imgEl=a('<img style="position: absolute; margin: 0; padding: 0; border: none; z-index: -999999;" />').bind("load error",a.proxy(this.onImageLoad,this)).appendTo(this.$fillmoreEl);this.$imgEl.attr("src",b)},onImageLoad:function(b){var c=b.target,d=this.getImageEl();if(c!==d[0]){return}if(this.$oldImage){this.$oldImage.remove();this.$oldImage=null}a.Fillmore.prototype.onImageLoad.apply(this,arguments);this.resize()},resize:function(){if(this.$imgEl&&this.imageLoaded){try{var c=this.calculateStretchedSizeAndOffsets();var b={left:"-"+c.offsetLeft+"px",top:"-"+c.offsetTop+"px"};this.$fillmoreEl.width(c.stretchedWidth).height(c.stretchedHeight);this.$imgEl.width(c.stretchedWidth).height(c.stretchedHeight).css(b)}catch(d){}}},destroy:function(){a(window).unbind("resize",this.resizeProxy);a.Fillmore.prototype.destroy.apply(this,arguments)}})})(jQuery);(function(b){var a={init:function(h){for(var f=0,c=this.length;f<c;f++){var g=this[f],e=b(g),d=e.data("fillmore");if(!d){if((b.Fillmore.useCss3&&!h.noCss3)||h.forceCss3){d=new b.FillmoreCss3(g)}else{d=new b.FillmoreImageStretch(g)}e.data("fillmore",d)}d.updateSettings(h);d.showImage(h.src)}return this},getSrc:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.getSrc()}else{return undefined}},getImageSize:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.getImageSize()}else{return undefined}},getViewableImageArea:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.getViewableImageArea()}else{return undefined}},isLoaded:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.isLoaded()}else{return false}},imageIsLoaded:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.imageIsLoaded()}else{return false}},imageIsVisible:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.imageIsVisible()}else{return false}},resize:function(){for(var f=0,c=this.length;f<c;f++){var e=b(this[f]),d=e.data("fillmore");if(d){d.resize()}}return this},destroy:function(){for(var f=0,c=this.length;f<c;f++){var e=b(this[f]),d=e.data("fillmore");if(d){d.destroy();e.removeData("fillmore")}}return this}};b.fn.fillmore=function(c){if(typeof c==="string"&&a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method '"+c+"' does not exist on Fillmore.")}}};b.fillmore=function(c){return b("body").fillmore(c)}})(jQuery);